<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <link rel="stylesheet" href="styles.css" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Tauri App</title>
    <script type="module" src="./main.js"></script>
    <style id="forjs">
    </style>
</head>

<body>
    <div id="tab-container">
        <div id="login-tab" class="visible-tab">
            <div class="hook button-wrapper non-selectable" id="change-to-login">
                <button type="button">Use exist Fileset</button>
            </div>
            <div id="login-main" class="main">
                <!--最大で5行程度の表示, overflowはscrollにすること.
                        行が選択されたらその行だけ残す-->
                <table id="fileset-manager">
                    <thead>
                        <tr>
                            <th style="width:20px" class="select non-selectable"><!--チェックマーク--></th>
                            <th style="width:200px;" class="select non-selectable">名前</th>
                            <th style="width:20px;" class="select non-selectable"><!--鍵マーク--></th>
                            <th style="width:150px;" class="select non-selectable">最終利用日時</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                        </tr>
                        <tr>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                        </tr>
                        <tr>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                        </tr>
                        <tr>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                        </tr>
                        <tr>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                        </tr>
                        <tr>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                        </tr>
                    </tbody>
                </table>
                <div class="group non-selectable" id="login-password-group">
                    <label>Password
                        <input class="selectable" type="password" id="login-password" name="password" /></label>
                    <p class="msg"></p>
                </div>
                <div class="button-wrapper non-selectable">
                    <button type="button" id="login-button">Login</button>
                </div>
            </div>
        </div>
        <div id="register-tab" class="hidden-tab">
            <div class="hook button-wrapper non-selectable">
                <button type="button" id="change-to-register">Make new fileset?</button>
            </div>
            <div id="register-main" class="main">
                <div class="group non-selectable" id="fileset-name-group">
                    <label>Fileset name
                        <input class="selectable" type="text" id="fileset-name" name="fileset-name" /></label>
                    <p class="msg"></p>
                </div>
                <div class="group non-selectable" id="need-password-group">
                    <label>Need password?
                        <input type="checkbox" name="need-password" id="need-password" /></label>
                </div>
                <div class="group non-selectable" id="password-group">
                    <label>Password
                        <input class="selectable" type="password" id="registration-password" name="password" /></label>
                    <p class="msg"></p>
                </div>
                <div class="button-wrapper">
                    <button class="non-selectable" type="button" id="registration-button">Register</button>
                </div>
            </div>
        </div>
    </div>

    <div id="main" class="inactive">
        <div id="fileset-editor-container">
            <div class="cover non-selectable">
                <div class="bottom-button">
                    <img src="assets/svg/tag.svg">
                </div>
                <div class="bottom-button">
                    <img src="assets/svg/rectangle.svg">
                    <img class="hidden" src="assets/svg/checkbox.svg">
                </div>
            </div>
            <div class="hidden fileset-editor">
                <div class="fileset-header">
                    <div class="fileset-name">
                        <input type="text" placeholder="名前" name="fileset-name" title="fileset-name">
                    </div>
                    <div class="fileset-path">
                        <div class="flex-wrapper">
                            <input type="text" placeholder="パス" name="fileset-path" title="file">
                            <button class="non-selectable" type="button">
                                Browse
                            </button>
                        </div>
                    </div>
                </div>
                <div class="non-selectable bottom-area">
                    <div class="bottom-button tag-button" aria-label="button to edit tags for fileset">
                        <img src="assets/svg/tag.svg" alt="change its tag">
                    </div>
                    <div class="bottom-button add-button" aria-label="button to add fileset">
                        <img src="assets/svg/rectangle.svg" alt="click here to add new fileset">
                        <img class="hidden" src="assets/svg/checkbox.svg" alt="click here to add new file">
                    </div>
                </div>
                <div class="tags hidden non-selectable">
                    <p class="tag">Programming</p>
                    <p class="tag">Libraries</p>
                <p class="tag">Stylesheets</p>
                    <p class="tag">Game</p>
                    <p class="tag">AndSome</p>
                </div>
            </div>
        </div>
        <ul id="filesets">
        </ul>
    </div>
    <script defer>
    document.querySelectorAll(".add-button").forEach((t) => {
        t.addEventListener("mouseover", () => {
            t.querySelectorAll(".add-button img").forEach((element) => {
                element.classList.toggle("hidden");
            });
        });
    })
    document.querySelectorAll(".add-button").forEach((t) => {
        t.addEventListener("mouseout", () => {
            t.querySelectorAll(".add-button img").forEach((element) => {
                element.classList.toggle("hidden");
            });
        });
    })
    document.querySelectorAll(".tag-button").forEach((t) => {
        t.addEventListener("click", () => {
            t.parentElement.parentElement.querySelector(".tags").classList.toggle("hidden");
        });
    })
        // ホイールで横スクロール
    document.querySelectorAll(".tags").forEach((t) => {
        t.addEventListener("mousewheel", e => {
            if (e.deltaX === 0) {
                e.stopPropagation()
                e.preventDefault()
                t.scrollBy(e.deltaY, 0)
            }
        })
    })
    let container = document.querySelector("#fileset-editor-container");
        container.addEventListener("click", () => {
            // coverにhiddenがなければhiddenを付与し, contentのhiddenを削除    
            if (!container.querySelector(".cover").classList.contains("hidden")) {
                container.querySelector(".cover").classList.add("hidden");
                container.querySelector(".fileset-editor").classList.remove("hidden");
            }
        })
        // クリックした位置がcontainer以外ならcoverにhiddenを削除し, contentにhiddenを付与
        document.addEventListener("click", (e) => {
            if (!container.contains(e.target)) {
                if (!container.querySelector(".fileset-editor").classList.contains("hidden")) {
                    container.querySelector(".cover").classList.remove("hidden");
                    container.querySelector(".fileset-editor").classList.add("hidden");
                }
            }
        })
    document.querySelectorAll(".fileset-editor .tags .tag").forEach((tag) => {
            tag.addEventListener("click", () => {
                tag.classList.toggle("selected");
            })
        })
    </script>
</body>

</html>